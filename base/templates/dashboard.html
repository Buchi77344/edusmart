{% extends 'sidebar.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
{% load static %}

<style>
  .profile-pic {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    font-size: 20px;
    border-radius: 50%;
    object-fit: cover;
    display: block;
  }

  .profile-initial {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    font-size: 20px;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    text-transform: uppercase;
  }

  .hamburger {
    display: none;
    flex-direction: column;
    gap: 4px;
    transform: translateY(1px);
    cursor: pointer;
  }

  .hamburger span {
    height: 3px;
    width: 28px;
    background-color: black;
    border-radius: 4px;
  }

  @media(max-width : 768px) {
    .hamburger {
      display: flex;
    }
  }
</style>

<!-- Header -->
<div class="flex justify-between items-center mb-6">
  <div>
    <div class="flex items-center gap-2 mb-1">
      <div class="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <h2 class="text-3xl font-semibold text-gray-800">Dashboard</h2>
    </div>
    <p class="text-sm text-gray-500">Welcome back, Admin</p>
  </div>
  <div class="flex items-center gap-2">
    <span class="notification-span">
      <svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M10.146 3.248a2 2 0 0 1 3.708 0A7.003 7.003 0 0 1 19 10v4.697l1.832 2.748A1 1 0 0 1 20 19h-4.535a3.501 3.501 0 0 1-6.93 0H4a1 1 0 0 1-.832-1.555L5 14.697V10c0-3.224 2.18-5.94 5.146-6.752zM10.586 19a1.5 1.5 0 0 0 2.829 0h-2.83zM12 5a5 5 0 0 0-5 5v5a1 1 0 0 1-.168.555L5.869 17H18.13l-.963-1.445A1 1 0 0 1 17 15v-5a5 5 0 0 0-5-5z"
          fill="#0D0D0D" />
      </svg>
    </span>
    <div class="profile" id="profileContainer"></div>
    <!-- <img src="{% static 'img/testimonial_img_1.png' %}" alt="avatar" class="w-10 h-10 rounded-full border"> -->
  </div>
</div>

<!-- Metrics -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
  <div class="bg-white p-6 rounded-xl shadow">
    <h3 class="text-sm text-gray-500">Total Students</h3>
    <p class="text-2xl font-bold text-primary">1,240</p>
  </div>
  <div class="bg-white p-6 rounded-xl shadow">
    <h3 class="text-sm text-gray-500">Total Teachers</h3>
    <p class="text-2xl font-bold text-primary">89</p>
  </div>
  <div class="bg-white p-6 rounded-xl shadow">
    <h3 class="text-sm text-gray-500">Total Payments</h3>
    <p class="text-2xl font-bold text-green-600">₦5,200,000</p>
  </div>
  <div class="bg-white p-6 rounded-xl shadow">
    <h3 class="text-sm text-gray-500">Pending Fees</h3>
    <p class="text-2xl font-bold text-red-500">₦1,100,000</p>
  </div>
</div>

<!-- Payment Summary & Notifications -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
  <div class="bg-white p-6 rounded-xl shadow col-span-2">
    <h3 class="text-lg font-semibold text-gray-700 mb-4">Recent School Fee Payments</h3>
    <table class="w-full text-left text-sm">
      <thead>
        <tr class="text-gray-500 border-b">
          <th class="py-2">Student</th>
          <th class="py-2">Class</th>
          <th class="py-2">Amount</th>
          <th class="py-2">Date</th>
        </tr>
      </thead>
      <tbody class="text-gray-700">
        <tr class="border-b hover:bg-gray-50">
          <td class="py-2">Chinedu Okafor</td>
          <td class="py-2">SS3</td>
          <td class="py-2 text-green-600 font-medium">₦50,000</td>
          <td class="py-2">July 15, 2025</td>
        </tr>
        <tr class="border-b hover:bg-gray-50">
          <td class="py-2">Amaka Johnson</td>
          <td class="py-2">JSS2</td>
          <td class="py-2 text-green-600 font-medium">₦45,000</td>
          <td class="py-2">July 14, 2025</td>
        </tr>
        <tr class="hover:bg-gray-50">
          <td class="py-2">Ibrahim Musa</td>
          <td class="py-2">SS1</td>
          <td class="py-2 text-green-600 font-medium">₦47,000</td>
          <td class="py-2">July 12, 2025</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Notifications -->
  <div class="bg-white p-6 rounded-xl shadow">
    <h3 class="text-lg font-semibold text-gray-700 mb-4">Notifications</h3>
    <ul class="space-y-3 text-sm text-gray-600">
      <li class="flex items-start gap-2">
        <i class="fas fa-bell text-yellow-500 mt-1"></i>
        <span>Parent-teacher meeting scheduled for next Friday.</span>
      </li>
      <li class="flex items-start gap-2">
        <i class="fas fa-calendar-alt text-blue-500 mt-1"></i>
        <span>Mid-term exams begin in 2 weeks.</span>
      </li>
      <li class="flex items-start gap-2">
        <i class="fas fa-user-plus text-green-500 mt-1"></i>
        <span>New student registered: Olamide Samuel</span>
      </li>
    </ul>
  </div>
</div>



<!-- Term Info -->
<div class="bg-white p-6 rounded-xl shadow col-span-2">
  <h3 class="text-lg font-semibold text-gray-700 mb-4">Vital Info</h3>
  <div class="grid grid-cols-2 gap-4 text-sm text-gray-600">
    <div>✔️ Term: <span class="font-medium">3rd Term</span></div>
    <div>✔️ Year: <span class="font-medium">2024/2025</span></div>
    <div>✔️ Resumption: <span class="font-medium">Sept 9, 2025</span></div>
    <div>✔️ Attendance Rate: <span class="font-medium">91%</span></div>
    <div>✔️ Current Week: <span class="font-medium">4 of 12</span></div>
    <div>✔️ Exam Week: <span class="font-medium">Week 10</span></div>
  </div>
</div>
</div>

<script>
  function showProfile(containerId, name, imageUrl = null) {
    const container = document.getElementById(containerId);
    container.innerHTML = ''; // Clear previous

    if (imageUrl) {
      const img = document.createElement('img');
      img.src = imageUrl;
      img.alt = name;
      img.className = 'profile-pic';

      // Handle fallback if image fails
      img.onerror = () => {
        img.remove();
        showInitial(container, name);
      };

      container.appendChild(img);
    } else {
      showInitial(container, name);
    }
  }

  function showInitial(container, name) {
    const initial = name?.trim()?.charAt(0) || 'O';
    const div = document.createElement('div');
    div.className = 'profile-initial';

    // Generate a background color based on name
    const bgColor = getColorFromString(name);
    div.style.backgroundColor = bgColor;
    div.textContent = initial;

    container.appendChild(div);
  }

  function getColorFromString(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
      hash = str.charCodeAt(i) + ((hash << 5) - hash);
    }
    const color = `hsl(${hash % 360}, 60%, 50%)`;
    return color;
  }

  // Example usage:
  showProfile('profileContainer', 'Alice Johnson', ''); // no image


  const hamburger = document.querySelector(".hamburger")
  const closeMenu = document.querySelector(".close-menu")
  const sidebar = document.querySelector(".sidebar")

  hamburger.addEventListener("click", () => {
    sidebar.classList.add("show")
  })

  closeMenu.addEventListener("click", () => {
    sidebar.classList.remove("show")
  })

</script>
{% endblock %}